%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TEST FILE - Merit fuction map of a doublet with 2 variables
%
% Based on doublet design used in "Fractal Basins of Attraction" paper
% (Turnhout et al, 2008)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% constants - all come from Turnhout et. al. (2008)
EFL = 100;    % effective focal length
r1 = 1/0.020; % radius of curvature of first glass surface
r4 = inf;     % radius of curvature of last glass surface (sol
d0 = 300;     % distance from object to first element (not from paper - made up)
d1 = 10.346;  % thickness of first element
d2 = 1;       % air gap between first and second element
d3 = 2.351;   % thickeness of second element;
d4 = 0;       % distance from last surface to image plane - solved of later
n1 = 1.618;   % index of refraction of first element 
n2 = 1.717;   % index of refraction of second element
sd = 33.33/2; % semidiamter of first element

na = 1;       % index of refraction of air

r2 = inf;
r3 = inf;

% create camera
clear camera
camera(1) = struct('R', inf,'d', d0, 'n', na, 'sd', inf);   % Object plane
camera(2) = struct('R', r1, 'd', d1, 'n', n1, 'sd', sd);
camera(3) = struct('R', r2, 'd', d2, 'n', na, 'sd', sd);
camera(4) = struct('R', r3, 'd', d3, 'n', n2, 'sd', sd);
camera(5) = struct('R', r4, 'd', d4,  'n', na, 'sd', inf);
[camera, r4] = calc_lastr(camera, EFL); % set last radius of curvature, r4
[camera, d4] = calc_lastd(camera);      % set distance to image plane, d4



